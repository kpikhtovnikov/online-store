{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _defineProperty from\"/home/kirill/online-store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/kirill/online-store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/kirill/online-store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/kirill/online-store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import Modal from\"react-bootstrap/Modal\";import{Button,Dropdown,Form,Row,Col}from\"react-bootstrap\";import{Context}from\"../../index\";import{createDevice,fetchBrands,fetchDevices,fetchTypes}from\"../../http/deviceAPI\";import{observer}from\"mobx-react-lite\";var CreateDevice=observer(function(_ref){var show=_ref.show,onHide=_ref.onHide;var _useContext=useContext(Context),device=_useContext.device;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),price=_useState4[0],setPrice=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),info=_useState8[0],setInfo=_useState8[1];useEffect(function(){fetchTypes().then(function(data){return device.setTypes(data);});fetchBrands().then(function(data){return device.setBrands(data);});},[]);var addInfo=function addInfo(){setInfo([].concat(_toConsumableArray(info),[{title:'',description:'',number:Date.now()}]));};var removeInfo=function removeInfo(number){setInfo(info.filter(function(i){return i.number!==number;}));};var changeInfo=function changeInfo(key,value,number){setInfo(info.map(function(i){return i.number===number?_objectSpread(_objectSpread({},i),{},_defineProperty({},key,value)):i;}));};var selectFile=function selectFile(e){setFile(e.target.files[0]);};var addDevice=function addDevice(){var formData=new FormData();formData.append('name',name);formData.append('price',\"\".concat(price));formData.append('img',file);formData.append('brandId',device.selectedBrand.id);formData.append('typeId',device.selectedType.id);formData.append('info',JSON.stringify(info));createDevice(formData).then(function(data){return onHide();});};return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onHide,centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{id:\"contained-modal-title-vcenter\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u043E\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:device.selectedType.name||\"Выберите тип\"}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:device.types.map(function(type){return/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return device.setSelectedType(type);},children:type.name},type.id);})})]}),/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:device.selectedBrand.name||\"Выберите тип\"}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:device.brands.map(function(brand){return/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return device.setSelectedBrand(brand);},children:brand.name},brand.id);})})]}),/*#__PURE__*/_jsx(Form.Control,{value:name,onChange:function onChange(e){return setName(e.target.value);},className:\"mt-3\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430\"}),/*#__PURE__*/_jsx(Form.Control,{value:price,onChange:function onChange(e){return setPrice(Number(e.target.value));},className:\"mt-3\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430\",type:\"number\"}),/*#__PURE__*/_jsx(Form.Control,{className:\"mt-3\",type:\"file\",onChange:selectFile}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Button,{variant:\"outline-dark\",onClick:addInfo,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u043E\\u0435 \\u0441\\u0432\\u043E\\u0439\\u0441\\u0442\\u0432\\u043E\"}),info.map(function(i){return/*#__PURE__*/_jsxs(Row,{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Form.Control,{value:i.title,onChange:function onChange(e){return changeInfo('title',e.target.value,i.number);},placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0441\\u0432\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430\"})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Form.Control,{value:i.description,onChange:function onChange(e){return changeInfo('description',e.target.value,i.number);},placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 \\u0441\\u0432\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430\"})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return removeInfo(i.number);},variant:\"outline-danger\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})})]},i.number);})]})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:onHide,children:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",onClick:addDevice,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]});});export default CreateDevice;","map":{"version":3,"sources":["/home/kirill/online-store/client/src/components/modals/CreateDevice.js"],"names":["React","useContext","useEffect","useState","Modal","Button","Dropdown","Form","Row","Col","Context","createDevice","fetchBrands","fetchDevices","fetchTypes","observer","CreateDevice","show","onHide","device","name","setName","price","setPrice","file","setFile","info","setInfo","then","data","setTypes","setBrands","addInfo","title","description","number","Date","now","removeInfo","filter","i","changeInfo","key","value","map","selectFile","e","target","files","addDevice","formData","FormData","append","selectedBrand","id","selectedType","JSON","stringify","types","type","setSelectedType","brands","brand","setSelectedBrand","Number"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport {Button, Dropdown, Form, Row, Col} from \"react-bootstrap\";\nimport {Context} from \"../../index\";\nimport {createDevice, fetchBrands, fetchDevices, fetchTypes} from \"../../http/deviceAPI\";\nimport {observer} from \"mobx-react-lite\";\n\nconst CreateDevice = observer(({show, onHide}) => {\n    const {device} = useContext(Context)\n    const [name, setName] = useState('')\n    const [price, setPrice] = useState(0)\n    const [file, setFile] = useState(null)\n    const [info, setInfo] = useState([])\n\n    useEffect(() => {\n        fetchTypes().then(data => device.setTypes(data))\n        fetchBrands().then(data => device.setBrands(data))\n    }, [])\n\n    const addInfo = () => {\n        setInfo([...info, {title: '', description: '', number: Date.now()}])\n    }\n    const removeInfo = (number) => {\n        setInfo(info.filter(i => i.number !== number))\n    }\n    const changeInfo = (key, value, number) => {\n        setInfo(info.map(i => i.number === number ? {...i, [key]: value} : i))\n    }\n\n    const selectFile = e => {\n        setFile(e.target.files[0])\n    }\n\n    const addDevice = () => {\n        const formData = new FormData()\n        formData.append('name', name)\n        formData.append('price', `${price}`)\n        formData.append('img', file)\n        formData.append('brandId', device.selectedBrand.id)\n        formData.append('typeId', device.selectedType.id)\n        formData.append('info', JSON.stringify(info))\n        createDevice(formData).then(data => onHide())\n    }\n\n    return (\n        <Modal\n            show={show}\n            onHide={onHide}\n            centered\n        >\n            <Modal.Header closeButton>\n                <Modal.Title id=\"contained-modal-title-vcenter\">\n                    Добавить устройство\n                </Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n                <Form>\n                    <Dropdown className=\"mt-2 mb-2\">\n                        <Dropdown.Toggle>{device.selectedType.name || \"Выберите тип\"}</Dropdown.Toggle>\n                        <Dropdown.Menu>\n                            {device.types.map(type =>\n                                <Dropdown.Item\n                                    onClick={() => device.setSelectedType(type)}\n                                    key={type.id}\n                                >\n                                    {type.name}\n                                </Dropdown.Item>\n                            )}\n                        </Dropdown.Menu>\n                    </Dropdown>\n                    <Dropdown className=\"mt-2 mb-2\">\n                        <Dropdown.Toggle>{device.selectedBrand.name || \"Выберите тип\"}</Dropdown.Toggle>\n                        <Dropdown.Menu>\n                            {device.brands.map(brand =>\n                                <Dropdown.Item\n                                    onClick={() => device.setSelectedBrand(brand)}\n                                    key={brand.id}\n                                >\n                                    {brand.name}\n                                </Dropdown.Item>\n                            )}\n                        </Dropdown.Menu>\n                    </Dropdown>\n                    <Form.Control\n                        value={name}\n                        onChange={e => setName(e.target.value)}\n                        className=\"mt-3\"\n                        placeholder=\"Введите название устройства\"\n                    />\n                    <Form.Control\n                        value={price}\n                        onChange={e => setPrice(Number(e.target.value))}\n                        className=\"mt-3\"\n                        placeholder=\"Введите стоимость устройства\"\n                        type=\"number\"\n                    />\n                    <Form.Control\n                        className=\"mt-3\"\n                        type=\"file\"\n                        onChange={selectFile}\n                    />\n                    <hr/>\n                    <Button\n                        variant={\"outline-dark\"}\n                        onClick={addInfo}\n                    >\n                        Добавить новое свойство\n                    </Button>\n                    {info.map(i =>\n                        <Row className=\"mt-4\" key={i.number}>\n                            <Col md={4}>\n                                <Form.Control\n                                    value={i.title}\n                                    onChange={(e) => changeInfo('title', e.target.value, i.number)}\n                                    placeholder=\"Введите название свойства\"\n                                />\n                            </Col>\n                            <Col md={4}>\n                                <Form.Control\n                                    value={i.description}\n                                    onChange={(e) => changeInfo('description', e.target.value, i.number)}\n                                    placeholder=\"Введите описание свойства\"\n                                />\n                            </Col>\n                            <Col md={4}>\n                                <Button\n                                    onClick={() => removeInfo(i.number)}\n                                    variant={\"outline-danger\"}\n                                >\n                                    Удалить\n                                </Button>\n                            </Col>\n                        </Row>\n                    )}\n                </Form>\n            </Modal.Body>\n            <Modal.Footer>\n                <Button variant=\"outline-danger\" onClick={onHide}>Закрыть</Button>\n                <Button variant=\"outline-success\" onClick={addDevice}>Добавить</Button>\n            </Modal.Footer>\n        </Modal>\n    );\n});\n\nexport default CreateDevice;\n"]},"metadata":{},"sourceType":"module"}